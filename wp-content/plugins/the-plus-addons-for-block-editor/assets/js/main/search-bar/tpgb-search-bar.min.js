document.addEventListener("DOMContentLoaded",function(){let a=document.querySelectorAll(".tpgb-search-bar");a&&a.forEach(function(a){var b=a.querySelector(".tpgb-search-form"),c=a.querySelector(".tpgb-search-list-inner"),d=a.querySelector(".tpgb-search-area"),e=a.querySelector(".tpgb-search-header"),f=a.dataset.ajax_search?JSON.parse(a.dataset.ajax_search):[],g=a.dataset.acfdata?JSON.parse(a.dataset.acfdata):[],h=a.dataset.genericfilter?JSON.parse(a.dataset.genericfilter):[],i=a.dataset.resultSetting?JSON.parse(a.dataset.resultSetting):[],j=a.dataset.paginationData?JSON.parse(a.dataset.paginationData):[],k=a.dataset.defaultData?JSON.parse(a.dataset.defaultData):[];c.style.transform="translateX(0)";let l=a.querySelector(".tpgb-rental-overlay");l&&tp_overlay_body(a);let m=a.querySelectorAll(".tpgb-sbar-dropdown");if(0<m.length&&m.forEach(function(a){a.addEventListener("click",function(){this.setAttribute("tabindex",1),this.classList.toggle("active");let a=this.querySelector(".tpgb-sbar-dropdown-menu");slideToggleP(a,300)}),a.addEventListener("focusout",function(){this.classList.remove("active");let a=this.querySelector(".tpgb-sbar-dropdown-menu");slideUpP(a,300)});var b=a.querySelectorAll(".tpgb-sbar-dropdown-menu .tpgb-searchbar-li");b.forEach(function(a){a.addEventListener("click",function(){var a=this.closest(".tpgb-sbar-dropdown");a.querySelector("span.search-selected-text").textContent=this.textContent;let b=a.querySelector("input");b.value=b.getAttribute("data-extra")?b.getAttribute("data-extra")+","+this.getAttribute("id"):this.getAttribute("id");var c=new Event("change",{bubbles:!0});a.querySelector("input").dispatchEvent(c)})})}),"yes"==f.ajax){function l(b){let c=b.type,d=a.querySelector("input[name=s]")?a.querySelector("input[name=s]").value:"",e=a.querySelector("input[name=post_type]")?a.querySelector("input[name=post_type]").value:"",f=a.querySelector("input[name=taxonomy]")?a.querySelector("input[name=taxonomy]").value:"",g=a.querySelector("input[name=cat]")?a.querySelector("input[name=cat]").value:"";if("keyup"===c&&d&&d.length>=o||"change"===c&&(e&&0===n||e&&d&&d.length>=o||""===e&&d.length>=o||g&&0===n||g&&d&&d.length>=o||""===g&&d&&d.length>=o)){let b=a.querySelector(".tpgb-close-btn"),e=a.querySelector(".tpgb-ajx-loading"),f=a.querySelector(".tpgb-dd-icon"),g="keyup"===c?1e3:300;clearTimeout(p),p=setTimeout(function(){b&&(b.style.display="none"),a.classList.contains("tpgb-ser-input-dis")&&(f.style.display="none"),e&&(e.style.display="flex"),m(d)},g)}}function m(){let l=a.querySelector("input[name=s]")?a.querySelector("input[name=s]").value:"",m=a.querySelector("input[name=taxonomy]")?a.querySelector("input[name=taxonomy]").value:"",n=a.querySelector("input[name=post_type]")?a.querySelector("input[name=post_type]").value:"";c.innerHTML="";let o=e.querySelector(".tpgb-search-pagina");o&&(o.innerHTML="");let p=new URLSearchParams(new FormData(b)).toString(),r={action:"tpgb_search",searchData:p,text:l,postper:f.post_page,GFilter:h,ACFilter:g,styleColumn:f.styleColumn,style:f.style,tempId:f.tempid,ResultData:j,DefaultData:k,resultSetting:i,nonce:f.nonce};jQuery.ajax({url:tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl,method:"post",async:!0,data:r,beforeSend:function(){"pagination"==j.Pagestyle&&(a.querySelector(".tpgb-search-list-inner").style.cssText="transform: translateX(0px)")},success:function(b){let f=a.querySelectorAll(".tpgb-search-error"),g=a.querySelector(".tpgb-search-header");if(b.data.error&&0<f.length)return f[0].style.cssText="display:block",f[0].innerHTML=b.data.message,g.style.cssText="display:none",void slideDownP(d,100);f[0].style.cssText="display:none",g.style.cssText="display:flex",f[0].innerHTML="";var h=b.data?b.data:"";if(h&&0!==h.post_count){let b=h.posts,f=null,g="",k="<div class=\""+".tpgb-search-slider tpgb-row".replace(".","")+"\">%s</div>",l="";for(f in slideDownP(d,100),b)l+=b[f],(0==(parseInt(f)+1)%h.limit_query||parseInt(f)===b.length-1)&&(g+=k.replace("%s",l),l="");if(c.innerHTML=g,i.TotalResult){let a=i.TotalResultTxt?i.TotalResultTxt:"",b=e.querySelector(".tpgb-search-resultcount");b&&(b.innerHTML=h.post_count+" "+a)}if(h.pagination){a.querySelector(".tpgb-search-pagina").innerHTML=h.pagination;let b=h.columns?h.columns:"";tp_pagination_ajax(b,r,j,a)}else if(null!=h.loadmore){let b=a.querySelector(".tpgb-load-more");if(!h.loadmore)b.innerHTML="";else if(h.total_count>h.limit_query)b.innerHTML=h.loadmore,tp_loadmore_ajax(h,r,j,a);else{let b=a.querySelectorAll(".tpgb-search-pagina");0<b.length&&(b[0].innerHTML=h.loadmore_page)}}else if(h.lazymore){let b=a.querySelector(".tpgb-lazy-load");h.total_count>h.limit_query?(b.innerHTML=h.lazymore,tp_lazymore_ajax(r,j,a)):b.innerHTML=""}}else return f[0].style.cssText="display:block",f[0].innerHTML=i.errormsg,g.style.cssText="display:none",void slideDownP(d,100)},complete:function(){let a=document.querySelectorAll(".tpgb-search-input");0<a.length&&a.forEach(a=>{setTimeout(function(){a.blur()},500)})}}).then(function(){setTimeout(function(){var b=a.querySelector(".tpgb-close-btn"),c=a.querySelector(".tpgb-ajx-loading");c&&(c.style.cssText="display:none"),b&&(b.style.cssText="display:flex")},500),q()})}function q(){let b=a.querySelector(".tpgb-search-area"),c=a.querySelector("input[name=s]"),d=a.querySelector(".tpgb-rental-overlay"),f=a.querySelector(".tpgb-close-btn"),g=a.querySelector(".tpgb-dd-icon");f&&f.addEventListener("click",f=>{c&&(c.value=""),f.currentTarget.style.display="none",slideUpP(b),d&&(d.style.cssText="visibility:hidden;opacity:0;"),a.classList.contains("tpgb-ser-input-dis")&&(g.style.cssText="display:flex")}),a.addEventListener("keyup",a=>{"Escape"===a.key&&(c.value="",slideUpP(b),f.style.cssText="display:none")})}var n=k&&k.SpecialCTP?k.SpecialCTP:0,o=f&&f.ajaxsearchCharLimit?f.ajaxsearchCharLimit:0;let r=new URLSearchParams(new FormData(b)).toString(),s={action:"tpgb_search",searchData:r,text:"",postper:f.post_page,GFilter:h,ACFilter:g,styleColumn:f.styleColumn,style:f.style,tempId:f.tempid,ResultData:j,DefaultData:k,resultSetting:i,nonce:f.nonce},t=d.querySelector(".post-load-more");t&&tp_loadmore_ajax("",s,j,a);let u=d.querySelector(".post-lazy-load");u&&tp_lazymore_ajax(s,j,a);let v=d.querySelector(".tpgb-search-pagina");if(v&&""!=v.innerHTML){let b=v.getAttribute("data-pageColumn");b=b?b:"",tp_pagination_ajax(b,s,j,a)}b.addEventListener("keypress",function(a){var b=a.keyCode||a.which;if("Enter"===a.key||13===b)return a.stopPropagation(),a.preventDefault(),!1});var p=null;a.addEventListener("change",l),a.addEventListener("keyup",l)}})});function tp_loadmore_ajax(a,b,c,d){let e=d.querySelector(".post-load-more"),f=d.querySelector(".tpgb-search-slider"),g=d.querySelector(".tpgb-search-pagina");g&&a&&(g.innerHTML=a.loadmore_page),e&&e.addEventListener("click",function(){let a=+this.dataset.page,h=+(a+1),i=d.querySelectorAll(".tpgb-ser-item");b.offset=i.length,b.loadNumpost=c.loadnumber,jQuery.ajax({url:tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl,method:"post",async:!0,data:b,beforeSend:function(){e.textContent=c.loadingtxt},success:function(a){e.textContent=c.loadbtntxt;let b=a.data.posts,i=a.data.total_count,j=null,k="";for(j in b)k+=b[j];if(f.innerHTML+=k,e.setAttribute("data-page",h),g){let a=g.querySelector(".tpgb-load-number");a.textContent=h}let l=d.querySelectorAll(".tpgb-ser-item");if(l.length==i){e.classList.add("tp-hide");var m=e.parentNode;m.innerHTML+="<div class=\"tpgb-post-loaded\">"+c.loadedtxt+"</div>"}},complete:function(){}})})}function tp_lazymore_ajax(a,b,c){function d(d){d.preventDefault(),o(),k=n.pageYOffset||n.scrollTop;let g=c.querySelector(".tpgb-search-area");l=g.offsetHeight,m=g.offsetTop+50;var h=g.querySelector(".post-lazy-load"),p=c.querySelectorAll(".tpgb-ser-item");if(a.offset=p.length,a.loadNumpost=b.loadnumber,h&&k<j&&k+60>l+m-i){if(jQuery(h).data("requestRunning"))return;jQuery(h).data("requestRunning",!0),jQuery.ajax({url:tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl,method:"post",async:!0,data:a,beforeSend:function(){},success:function(a){let d=a.data.posts,g=a.data.total_count,h=null,i="";for(h in d)i+=d[h];f.innerHTML+=i;let j=c.querySelectorAll(".tpgb-ser-item");if(j.length==g){e.classList.add("tp-hide");var k=e.parentNode;k.innerHTML+="<div class=\"tpgb-post-loaded\">"+b.loadedtxt+"</div>",b.loadedtxt&&setTimeout(()=>{k.innerHTML=""},1e3)}},complete:function(){jQuery(h).data("requestRunning",!1)}})}}let e=c.querySelector(".post-lazy-load"),f=c.querySelector(".tpgb-search-slider"),g=c.querySelectorAll(".tpgb-search-pagina");var h,i,j,k,l,m,n=window,o=function(){h=n.innerWidth,i=n.innerHeight,j=document.body.offsetHeight,l=c.querySelector(".tpgb-search-area").offsetHeight,m=c.querySelector(".tpgb-search-area").offsetTop+50,setTimeout(function(){l=c.querySelector(".tpgb-search-area").offsetHeight,m=c.querySelector(".tpgb-search-area").offsetTop+50},50)};o(),n.addEventListener("resize",o),jQuery(n).unbind("scroll"),jQuery(n).bind("scroll",a=>{d(a)})}function tp_pagination_ajax(a,b,c,d){let e=d.querySelector(".tpgb-search-list-inner"),f=d.querySelectorAll(".tpgb-pagelink.tpgb-ajax-page"),g=d.querySelector(".tpgb-pagelink.next"),h=d.querySelector(".tpgb-pagelink.prev"),i=c.Pcounter?c.Pcounter:0,j=c.PClimit?c.PClimit:3;var k=c.PNavigation?c.PNavigation:0,l=b&&b.post_page?b.post_page:3;0<f.length&&f.forEach(function(c,i){if(+c.dataset.page==1){let a=d.querySelector(".tpgb-search-slider");a&&a.classList.add("ajax-"+1)}else e&&(e.innerHTML+="<div class=\"tpgb-search-slider tpgb-row ajax-"+ +(i+1)+"\"></div>");c.addEventListener("click",function(){let c=this.dataset.page,j=100*i,l=d.querySelectorAll(".tpgb-ser-item");b.offset=l.length,tp_pagination_active(f,c),k&&(h.setAttribute("data-prev",c),g.setAttribute("data-next",c));let m=e.querySelector(".tpgb-search-slider.ajax-"+c);return m&&m.querySelector(".tpgb-ser-item")?(e.style.cssText="transform: translateX("+-j+"%)",void tp_pagination_hidden(a,d)):void jQuery.ajax({url:tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl,method:"post",async:!0,data:b,beforeSend:function(){},success:function(b){let c=b.data.posts,f=null,g="";for(f in c)g+=c[f];m.innerHTML+=g,e.style.cssText="transform: translateX("+-j+"%)",tp_pagination_hidden(a,d)},complete:function(){}})})}),g&&g.addEventListener("click",function(){let c=+this.dataset.next,l=c+1,m=-(c*100),n=d.querySelectorAll(".tpgb-ser-item");b.offset=n.length,i&&f.forEach(function(a,b){if(l==+a.dataset.page&&a.classList.contains("tp-hide")){a.classList.remove("tp-hide"),f.forEach(function(a,c){+(b+1-j)==c+1&&a.classList.add("tp-hide")})}}),tp_pagination_active(f,l),k&&(h.setAttribute("data-prev",l),g.setAttribute("data-next",l));let o=e.querySelector(".tpgb-search-slider.ajax-"+l);return o&&o.querySelector(".tpgb-ser-item")?(e.style.cssText="transform: translateX("+m+"%)",void tp_pagination_hidden(a,d)):void jQuery.ajax({url:tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl,method:"post",async:!0,data:b,beforeSend:function(){},success:function(b){let c=b.data.posts,f=null,g="";for(f in c)g+=c[f];o.innerHTML+=g,e.style.cssText="transform: translateX("+m+"%)",tp_pagination_hidden(a,d)},complete:function(){}})}),h&&h.addEventListener("click",function(){let c=+this.dataset.prev,l=c-1,m=-(100*l)+100,n=d.querySelectorAll(".tpgb-ser-item");b.offset=n.length,i&&f.forEach(function(a,b){if(l==+a.dataset.page&&a.classList.contains("tp-hide")){a.classList.remove("tp-hide"),f.forEach(function(a,c){+(b+1)+ +j==c+1&&a.classList.add("tp-hide")})}}),tp_pagination_active(f,l),k&&(h.setAttribute("data-prev",l),g.setAttribute("data-next",l));let o=e.querySelector(".tpgb-search-slider.ajax-"+l);return o&&o.querySelector(".tpgb-ser-item")?(e.style.cssText="transform: translateX("+m+"%)",void tp_pagination_hidden(a,d)):void jQuery.ajax({url:tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl,method:"post",async:!0,data:b,beforeSend:function(){},success:function(b){let c=b.data.posts,f=null,g="";for(f in c)g+=c[f];o.innerHTML+=g,e.style.cssText="transform: translateX("+m+"%)",tp_pagination_hidden(a,d)},complete:function(){}})})}function tp_pagination_hidden(a,b){if(a){let c=b.querySelector(".tpgb-pagelink.next"),d=b.querySelector(".tpgb-pagelink.prev");if(c){let b=c.dataset&&c.dataset.next?c.dataset.next:"";c.style.display=parseInt(b)==a?"none":"inline-block"}if(d){let a=d.dataset&&d.dataset.prev?d.dataset.prev:"";d.style.display=1==parseInt(a)?"none":"inline-block"}}}function tp_pagination_active(a,b){0<a.length&&a.forEach(function(a){b==+a.dataset.page?a.classList.add("active"):a.classList.contains("active")&&a.classList.remove("active")})}function tp_overlay_body(a){let b=a.querySelector(".tpgb-rental-overlay"),c=a.querySelector(".tpgb-input-field"),d=a.querySelector(".tpgb-search-input");d&&(d.addEventListener("focus",()=>{b.style.cssText="visibility:visible;opacity:1;",c.style.cssText="z-index:1000;"}),d.addEventListener("focusout",()=>{b.style.cssText="visibility:hidden;opacity:0;",c.style.cssText=""}));let e=a.querySelector(".tpgb-select");e&&e.addEventListener("click",()=>{b.style.cssText="visibility:visible;opacity:1;"}),b&&b.addEventListener("click",()=>{b.style.cssText="visibility:hidden;opacity:0;"}),a.addEventListener("keyup",a=>{"Escape"===a.key&&(b.style.cssText="visibility:hidden;opacity:0;")})}